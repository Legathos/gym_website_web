<div class="banner ">
  Welcome, <span class="username">{{this.user.username}}!</span>
</div>

<div class="top-row">
  <div class="square-box">
    <div class="inner-box">
      <div class="macro-value">Calories (kcal) {{this.calories  | number:'1.1-1' }}</div>
    </div>
    <div class="inner-box">
      <div class="macro-value protein-value">Protein (g) {{ this.protein | number:'1.1-1' }}</div>
    </div>
    <div class="inner-box">
      <div class="macro-value carbs-value">Carbs (g) {{ this.carbs | number:'1.1-1' }}</div>
    </div>
    <div class="inner-box">
      <div class="macro-value fats-value">Fats (g) {{ this.fats | number:'1.1-1' }}</div>
    </div>
  </div>
  <div class="square-box donut-chart-container">
    <canvas id="macros-chart"></canvas>
  </div>
</div>

  <div class="profile-card">
    <div class="d-flex align-items-center justify-content-between">
      <h2 class="card-title mb-0">Weight History</h2>
      <button (click)="openAddWeightDialog()" class="btn btn-sm add-weight-btn" style="background-color: #FF7124;
       color: white; width: 30px; height: 30px; padding: 0; display: flex; align-items: center; justify-content: center;
        font-weight: bolder; font-size: 20px;">
        +
      </button>
    </div>
    <div class="weight-chart" style="position: relative;">
      <!-- Loading spinner -->
      <div *ngIf="isWeightChartLoading" class="chart-loading-overlay">
        <div class="spinner-border text-primary" role="status">
          <span class="visually-hidden">Loading...</span>
        </div>
      </div>
      <canvas id="weight-chart"></canvas>
    </div>
  </div>

  <!-- Calories History Chart -->
  <div class="profile-card mt-3">
    <h2 class="card-title">Calories Intake History</h2>
    <div class="history-chart-container" style="height: 180px; position: relative;">
      <!-- Loading spinner -->
      <div *ngIf="isCaloriesLoading" class="chart-loading-overlay">
        <div class="spinner-border text-primary" role="status">
          <span class="visually-hidden">Loading...</span>
        </div>
      </div>
      <canvas #caloriesHistoryChart></canvas>
    </div>
    <div class="d-flex justify-content-center mt-3">
      <div aria-label="Calories period selection" class="period-selector btn-group" role="group">
        <button (click)="changePeriod(option.days, 'calories')"
                *ngFor="let option of periodOptions"
                [class.btn-outline-primary]="caloriesSelectedPeriod !== option.days"
                [class.btn-primary]="caloriesSelectedPeriod === option.days"
                [disabled]="isCaloriesLoading"
                class="btn btn-sm"
                type="button">
          {{ option.label }}
        </button>
      </div>
    </div>
  </div>

  <!-- Protein History Chart -->
  <div class="profile-card mt-3">
    <h2 class="card-title">Protein Intake History</h2>
    <div class="history-chart-container" style="height: 180px; position: relative;">
      <!-- Loading spinner -->
      <div *ngIf="isProteinLoading" class="chart-loading-overlay">
        <div class="spinner-border text-primary" role="status">
          <span class="visually-hidden">Loading...</span>
        </div>
      </div>
      <canvas #proteinHistoryChart></canvas>
    </div>
    <div class="d-flex justify-content-center mt-3">
      <div aria-label="Protein period selection" class="period-selector btn-group" role="group">
        <button (click)="changePeriod(option.days, 'protein')"
                *ngFor="let option of periodOptions"
                [class.btn-outline-primary]="proteinSelectedPeriod !== option.days"
                [class.btn-primary]="proteinSelectedPeriod === option.days"
                [disabled]="isProteinLoading"
                class="btn btn-sm"
                type="button">
          {{ option.label }}
        </button>
      </div>
    </div>
  </div>

  <!-- Carbs History Chart -->
  <div class="profile-card mt-3">
    <h2 class="card-title">Carbs Intake History</h2>
    <div class="history-chart-container" style="height: 180px; position: relative;">
      <!-- Loading spinner -->
      <div *ngIf="isCarbsLoading" class="chart-loading-overlay">
        <div class="spinner-border text-primary" role="status">
          <span class="visually-hidden">Loading...</span>
        </div>
      </div>
      <canvas #carbsHistoryChart></canvas>
    </div>
    <div class="d-flex justify-content-center mt-3">
      <div aria-label="Carbs period selection" class="period-selector btn-group" role="group">
        <button (click)="changePeriod(option.days, 'carbs')"
                *ngFor="let option of periodOptions"
                [class.btn-outline-primary]="carbsSelectedPeriod !== option.days"
                [class.btn-primary]="carbsSelectedPeriod === option.days"
                [disabled]="isCarbsLoading"
                class="btn btn-sm"
                type="button">
          {{ option.label }}
        </button>
      </div>
    </div>
  </div>

  <!-- Fat History Chart -->
  <div class="profile-card mt-3">
    <h2 class="card-title">Fat Intake History</h2>
    <div class="history-chart-container" style="height: 180px; position: relative;">
      <!-- Loading spinner -->
      <div *ngIf="isFatLoading" class="chart-loading-overlay">
        <div class="spinner-border text-primary" role="status">
          <span class="visually-hidden">Loading...</span>
        </div>
      </div>
      <canvas #fatHistoryChart></canvas>
    </div>
    <div class="d-flex justify-content-center mt-3">
      <div aria-label="Fat period selection" class="period-selector btn-group" role="group">
        <button (click)="changePeriod(option.days, 'fat')"
                *ngFor="let option of periodOptions"
                [class.btn-outline-primary]="fatSelectedPeriod !== option.days"
                [class.btn-primary]="fatSelectedPeriod === option.days"
                [disabled]="isFatLoading"
                class="btn btn-sm"
                type="button">
          {{ option.label }}
        </button>
      </div>
    </div>
  </div>
